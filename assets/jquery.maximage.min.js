(function(a){jQuery.fn.maxImage=function(e){var v={show:false,location:"before",message:"Original: ([w]w x [h]h)"};var o=jQuery.extend({wait:true,imageArray:[],maxFollows:"both",verticalOffset:0,horizontalOffset:0,leftSpace:0,topSpace:0,rightSpace:0,bottomSpace:0,overflow:"hidden",position:"absolute",isBackground:false,zIndex:-1,verticalAlign:"center",horizontalAlign:"center",maxAtOrigImageSize:false,slideShow:false,slideDelay:5,slideShowTitle:true,loaderClass:"loader",resizeMsg:v,onImageShow:function(){}},e);o.resizeMsg=jQuery.extend(v,e.resizeMsg);var g=this;function y(){u(this,g);return false}function u(A,z){if(o.slideShow){t(z)}else{if(o.isBackground){Background._setup_background(A)}else{Others._setup_others(A,o)}}}Others={_setup_others:function(A,z){$this=a(A);$this.hide();Others._configure_css(A,z);a(window).load(function(){d($this);n($this);x($this);$this.show();a("."+z.loaderClass).hide();z.onImageShow.call(this);a(window).resize(function(){n($this);x($this)})})},_configure_css:function(A,z){if(z.position=="absolute"){a(A).css({overflow:"hidden",left:z.leftSpace,top:z.topSpace,position:"absolute"});if(z.verticalAlign=="bottom"){a(A).css({bottom:z.bottomSpace,top:"auto"})}if(z.horizontalAlign=="right"){a(A).css({right:z.rightSpace,left:"auto"})}}else{a(A).css({"margin-top":z.topSpace,"margin-right":z.rightSpace,"margin-bottom":z.bottomSpace,"margin-left":z.leftSpace,position:z.position})}}};Background={_setup_background:function(z){$this=a(z);$this.hide();Background._configure_css(z);a(window).load(function(){d($this);n($this);x($this);$this.show();a("."+o.loaderClass).hide();o.onImageShow.call(this);a(window).resize(function(){n($this);x($this)})})},_configure_css:function(z){a(z).css({"z-index":o.zIndex});if(o.position=="absolute"){a(z).css({overflow:"hidden",left:o.leftSpace,top:o.topSpace,position:"absolute"});a("html").css({"overflow-y":o.overflow});if(o.verticalAlign=="bottom"){a(z).css({bottom:o.bottomSpace,top:"auto"})}if(o.horizontalAlign=="right"){a(z).css({right:o.rightSpace})}}else{a(z).css({"margin-top":o.topSpace,"margin-right":o.rightSpace,"margin-bottom":o.bottomSpace,"margin-left":o.leftSpace,position:o.position})}}};function t(A){m(A);o.imageArray.length=0;if(A.length==1){objClicked=A[0];o.imageArray.push(new Array(objClicked.getAttribute("src"),objClicked.getAttribute("title")))}else{for(var z=0;z<A.length;z++){o.imageArray.push(new Array(A[z].getAttribute("src"),A[z].getAttribute("title")));a(A[z]).attr("original",a(A[z]).attr("src")).attr("src","")}}j();w(0)}function m(){for(var z=0;z<g.length;z++){a(g[z]).addClass("slides slide-"+z).after('<div class="slideTitle">'+a(g[z]).attr("title")+"</div>")}a(".slideTitle").hide().css({height:"20px",padding:"10px",color:"#fff",background:"#000",position:"absolute",top:"0",right:"5%",opacity:"0.6"})}function w(B){var A=B;var z=new Image();z.onload=function(){a(".slide-"+A).attr("src",o.imageArray[A][0]);d(a(".slide-"+A));n(a(".slide-"+A));x(a(".slide-"+A));if(A==0){o.onImageShow.call(this)}a(window).resize(function(){n(a(".slide-"+A));x(a(".slide-"+A))});if(A==0){l()}if(A<o.imageArray.length-1){w(A+1)}};z.src=o.imageArray[A][0]}function l(){var z=0;a("."+o.loaderClass).hide();a(".slide-"+z).css({"z-index":o.zIndex}).fadeIn();if(o.slideShowTitle){a(".slide-"+z).next(".slideTitle").css({"z-index":o.zIndex+1}).fadeIn()}setTimeout(function(){b(z)},(s(o.slideDelay)*1000))}function b(z){if(z<o.imageArray.length-1){z++;lastSlide=z-1}else{z=0;lastSlide=o.imageArray.length-1}a(".slide-"+lastSlide).css({"z-index":o.zIndex-1}).fadeOut("slow");a(".slide-"+z).css({"z-index":o.zIndex}).fadeIn("slow");if(o.slideShowTitle){c(z,lastSlide)}setTimeout(function(){b(z)},(s(o.slideDelay)*1000))}function j(){for(i=0;i<o.imageArray.length;i++){if(o.position=="absolute"){a(".slide-"+i).css({position:"absolute",overflow:"hidden"});a("html").css({"overflow-y":o.overflow});if(o.verticalAlign=="bottom"){a(".slide-"+i).css({bottom:o.bottomSpace})}else{a(".slide-"+i).css({top:o.topSpace})}if(o.horizontalAlign=="right"){a(".slide-"+i).css({right:o.rightSpace})}else{a(".slide-"+i).css({left:o.leftSpace})}}else{a(".slide-"+i).css({"margin-top":o.topSpace,"margin-right":o.rightSpace,"margin-bottom":o.bottomSpace,"margin-left":o.leftSpace,position:o.position})}a(".slide-"+i).next(".slideTitle").css({position:"absolute",bottom:0,right:"5%"})}}function c(A,z){a(".slide-"+z).next(".slideTitle").fadeOut();a(".slide-"+A).next(".slideTitle").fadeIn()}function x(D){$this=D;if(o.horizontalAlign=="center"){var A=a(window).width()-o.horizontalOffset;var C=-1*($this.width()-A)/2;a(D).css({left:C})}if(o.verticalAlign=="center"){var B=a(window).height()-o.verticalOffset;var z=-1*($this.height()-B)/2;a(D).css({top:z})}}function d(z){$this=z;$this.attr("origWidth",$this.width());$this.attr("origHeight",$this.height());$this.attr("ratio",q($this.width(),$this.height()))}function n(C){$this=C;var D=s($this.attr("origWidth"));var B=s($this.attr("origHeight"));var A=$this.attr("ratio");if(D==0||B==0){setTimeout(function(){d(C);n(C)},100);return}var z=[];z=k(D,B,A);$this.width(z[0]);$this.height(z[1]);h(D,B,C)}function h(C,A,B){if((s($this.width())!=C||s($this.height())!=A)&&o.resizeMsg.show){a(".maximage_resized").remove();o.resizeMsg.message=o.resizeMsg.message.replace("[w]",C).replace("[h]",A);var z='<div class="maximage_resized">'+o.resizeMsg.message+"</div>";if(o.resizeMsg.location.toLowerCase()=="before"){$this.before(z)}else{$this.after(z)}}}function k(D,C,A){var z=a(window).width()-o.horizontalOffset;var B=a(window).height()-o.verticalOffset;if(!o.isBackground){if(o.maxFollows=="both"){f(z,A);if(height>B){r(B,A)}}else{if(o.maxFollows=="width"){f(z,A)}else{if(o.maxFollows=="height"){r(B,A)}}}}else{width=z+40;height=width/A;if(height<B){height=B-(o.topSpace+o.bottomSpace);width=height*A}}if(o.maxAtOrigImageSize&&width>D){arrayImageSize=new Array(D,C)}else{arrayImageSize=new Array(width,height)}return arrayImageSize}function r(A,z){height=A-(o.topSpace+o.bottomSpace);width=height*z}function f(z,A){width=z-(o.leftSpace+o.rightSpace);height=width/A}function q(B,z){B=s(B);z=s(z);var A=B/z;A=A.toFixed(2);return A}function s(z){last=parseInt(z);return last}function p(z){if(window.console&&window.console.log){window.console.log(z)}}return this.each(y)}})(jQuery);